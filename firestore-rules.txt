// SIMPLIFIED Firestore Security Rules for Testing
// Copy these rules to your Firebase Console > Firestore Database > Rules

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // TEMPORARY: Allow all reads and writes for testing
    // ⚠️ WARNING: These rules are for development/testing only!
    // ⚠️ Do NOT use in production!
    match /{document=**} {
      allow read, write: if true;
    }
  }
}

// PRODUCTION RULES (use these after testing works):
/*
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Notifications collection rules
    match /notifications/{notificationId} {
      // Allow read access to global notifications
      allow read: if resource.data.isGlobal == true;

      // Allow write access (you can restrict this later)
      allow write: if true;
    }

    // Users collection (if needed)
    match /users/{userId} {
      allow read, write: if true;
    }
  }
}
*/

// Alternative simpler rules if you don't have user roles set up yet:
/*
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Notifications collection - simplified rules
    match /notifications/{notificationId} {
      // Allow read access to global notifications
      allow read: if resource.data.isGlobal == true;
      
      // Allow authenticated users to update notifications (mark as read)
      allow update: if request.auth != null 
                    && request.resource.data.diff(resource.data).affectedKeys().hasOnly(['isRead']);
      
      // Allow authenticated users to delete notifications (dismiss)
      allow delete: if request.auth != null;
      
      // Allow authenticated users to create notifications (for testing)
      allow create: if request.auth != null;
    }
  }
}
*/

// Instructions for setting up:
// 1. Go to Firebase Console
// 2. Select your project
// 3. Go to Firestore Database
// 4. Click on "Rules" tab
// 5. Replace the existing rules with the rules above
// 6. Click "Publish"

// Note: The rules above assume you have a 'users' collection with role information.
// If you don't have user roles set up, use the simplified rules in the comment block.
